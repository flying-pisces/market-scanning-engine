# Kafka Topic Configurations for Market Scanning Engine
# High-throughput, low-latency topics for real-time market data processing

topics:
  # Raw Market Data Topics
  market-data-raw:
    partitions: 24
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 86400000  # 24 hours
    segment-ms: 3600000     # 1 hour
    compression-type: lz4
    min-insync-replicas: 2
    acks: all
    batch-size: 16384
    linger-ms: 5
    max-in-flight-requests: 5
    configs:
      min.cleanable.dirty.ratio: 0.1
      max.message.bytes: 1048576  # 1MB
      segment.bytes: 1073741824   # 1GB

  market-data-equity:
    partitions: 12
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 604800000  # 7 days
    segment-ms: 3600000
    compression-type: lz4
    min-insync-replicas: 2
    configs:
      segment.bytes: 536870912  # 512MB

  market-data-options:
    partitions: 8
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 604800000
    segment-ms: 3600000
    compression-type: lz4
    min-insync-replicas: 2

  market-data-forex:
    partitions: 6
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 2592000000  # 30 days
    segment-ms: 3600000
    compression-type: lz4

  # News and Sentiment Topics
  news-feed-raw:
    partitions: 8
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 2592000000
    segment-ms: 7200000
    compression-type: gzip

  sentiment-analysis:
    partitions: 6
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 604800000
    compression-type: gzip

  social-sentiment:
    partitions: 4
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 259200000  # 3 days
    compression-type: gzip

  # Economic Data Topics
  economic-indicators:
    partitions: 2
    replication-factor: 3
    cleanup-policy: compact
    retention-ms: 7776000000  # 90 days
    compression-type: gzip
    min-compaction-lag-ms: 3600000

  # Signal Generation Topics
  signals-generated:
    partitions: 16
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 2592000000
    segment-ms: 1800000  # 30 minutes
    compression-type: lz4
    min-insync-replicas: 2
    configs:
      max.message.bytes: 2097152  # 2MB

  signals-validated:
    partitions: 12
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 2592000000
    compression-type: lz4

  # Risk Assessment Topics
  risk-scores:
    partitions: 8
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 2592000000
    compression-type: lz4
    min-insync-replicas: 2

  risk-alerts:
    partitions: 4
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 7776000000  # 90 days
    compression-type: gzip

  # User Matching Topics
  user-signals-matched:
    partitions: 8
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 604800000
    compression-type: lz4

  # Notification Topics
  notifications-queue:
    partitions: 6
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 259200000  # 3 days
    compression-type: gzip
    min-insync-replicas: 2

  notifications-delivered:
    partitions: 4
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 604800000
    compression-type: gzip

  notifications-failed:
    partitions: 2
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 604800000
    compression-type: gzip

  # Dead Letter Topics
  dead-letter-queue:
    partitions: 4
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 2592000000
    compression-type: gzip

  # Monitoring Topics
  system-metrics:
    partitions: 4
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 604800000
    compression-type: gzip

  application-logs:
    partitions: 8
    replication-factor: 3
    cleanup-policy: delete
    retention-ms: 604800000
    compression-type: gzip

# Consumer Groups Configuration
consumer-groups:
  data-ingestion-group:
    topics:
      - market-data-raw
      - news-feed-raw
      - economic-indicators
    auto-offset-reset: latest
    enable-auto-commit: false
    max-poll-records: 1000
    fetch-min-bytes: 1024
    fetch-max-wait-ms: 500
    session-timeout-ms: 30000
    heartbeat-interval-ms: 3000
    max-poll-interval-ms: 300000

  signal-generation-group:
    topics:
      - market-data-equity
      - market-data-options
      - market-data-forex
      - sentiment-analysis
      - economic-indicators
    auto-offset-reset: earliest
    enable-auto-commit: false
    max-poll-records: 500
    fetch-min-bytes: 2048
    fetch-max-wait-ms: 100
    session-timeout-ms: 30000
    heartbeat-interval-ms: 3000

  risk-assessment-group:
    topics:
      - signals-validated
      - market-data-equity
      - economic-indicators
    auto-offset-reset: earliest
    enable-auto-commit: false
    max-poll-records: 200
    fetch-min-bytes: 1024
    fetch-max-wait-ms: 50
    session-timeout-ms: 30000
    heartbeat-interval-ms: 3000

  user-matching-group:
    topics:
      - risk-scores
      - signals-generated
    auto-offset-reset: latest
    enable-auto-commit: false
    max-poll-records: 100
    fetch-min-bytes: 512
    fetch-max-wait-ms: 10
    session-timeout-ms: 10000
    heartbeat-interval-ms: 3000

  notification-group:
    topics:
      - notifications-queue
    auto-offset-reset: latest
    enable-auto-commit: false
    max-poll-records: 50
    fetch-min-bytes: 256
    fetch-max-wait-ms: 5
    session-timeout-ms: 10000
    heartbeat-interval-ms: 3000

  monitoring-group:
    topics:
      - system-metrics
      - application-logs
    auto-offset-reset: latest
    enable-auto-commit: true
    max-poll-records: 1000
    fetch-min-bytes: 1024
    fetch-max-wait-ms: 1000